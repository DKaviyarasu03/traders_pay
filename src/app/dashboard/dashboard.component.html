<div class="w-100 overflow-hidden">

    <div class="topbar d-flex justify-content-between align-items-center px-4 py-3 rounded-0">
      <h4 class="mb-0 text-white">Open Stores List</h4>
      <button class="btn btn-light btn-sm" (click)="logout()">Logout</button>
    </div>
    <div class="container">

        <!-- Wallet Section -->
        <div class="row my-4">
          <div class="col-12 col-md-12 mb-3" *ngFor="let wallet of wallets">
            <div class="card text-center shadow-sm border-0 rounded-3 h-100">
              <div class="card-body bg-secondary-subtle">
                <h6 class="text-secondary">{{ wallet.name }}</h6>
                <h4 class="fw-bold" [ngClass]="wallet.color">₹ {{ wallet.amount | number:'1.2-2' }}</h4>
              </div>
            </div>
          </div>
        </div>
    
        <div class="row my-4">
          <div class="col-6 col-md-6 mb-3" *ngFor="let wallet of funds">
            <div class="card text-center shadow-sm border-0 rounded-3 h-100">
              <div class="card-body bg-primary-subtle">
                <h6 class="text-secondary">{{ wallet.name }}</h6>
                <!-- <h4 class="fw-bold" [ngClass]="wallet.color">₹ {{ wallet.amount | number:'1.2-2' }}</h4> -->
              </div>
            </div>
          </div>
        </div>
    </div>


    
    
    
    <div class="container py-4">
    
      <!-- Search -->
      <div class="mb-3">
        <input type="text" class="form-control" placeholder="Search with location or shop name" [(ngModel)]="searchText" (input)="filterData()" />
      </div>
    
      <!-- Table -->
      <div class="table-responsive">
        <table class="table table-striped table-hover" *ngIf="filteredData.length > 0">
          <thead class="table-dark">
            <tr>
              <th>S/No</th>
              <th>Shop Name</th>
              <th>Shop Code</th>
              <th>Owner</th>
              <th>Contact</th>
              <th>Address</th>
              <th>Route</th>

              <!-- <th>Income Wallet</th>
              <th>Purchase Wallet</th>
              <th>Coupon Wallet</th>
              <th>Pudhukadai Wallet</th>
              <th>Withdrawal Wallet</th>
              <th>Trader Wallet</th> -->
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let shop of paginatedData; let i = index" (click)="openShopModal(shop)">
              <td>{{ (currentPage - 1) * itemsPerPage + i + 1 }}</td>
              <td>{{ shop.shop_name }}</td>
              <td>{{ shop.shop_code }}</td>
              <td>{{ shop.owner_name }}</td>
              <td>{{ shop.contact_no }}</td>
              <td>{{ shop.shop_address }}</td>
              <td><button class="btn btn-dark"><i class="bi bi-geo-alt-fill"></i> Navigate </button></td>

              <!-- <td>{{ shop.income_wallet ? 'Active' : 'Inactive' }}</td>
              <td>{{ shop.purchase_wallet ? 'Active' : 'Inactive' }}</td>
              <td>{{ shop.coupon_wallet ? 'Active' : 'Inactive' }}</td>
              <td>{{ shop.pudhukadai_wallet ? 'Active' : 'Inactive' }}</td>
              <td>{{ shop.withdrawal_wallet ? 'Active' : 'Inactive' }}</td>
              <td>{{ shop.trader_wallet ? 'Active' : 'Inactive' }}</td> -->
            </tr>
          </tbody>
        </table>
    
        <!-- No results -->
        <div *ngIf="filteredData.length === 0" class="text-center py-5 text-muted">
          <strong>No results found</strong>
        </div>
      </div>
    
      <!-- Pagination -->
      <nav *ngIf="filteredData.length > 0" class="mt-3">
      <ul class="pagination justify-content-center flex-wrap">
        <li class="page-item" [class.disabled]="currentPage === 1">
          <button class="page-link" (click)="changePage(currentPage - 1)">Previous</button>
        </li>
        <li class="page-item" *ngFor="let page of totalPagesArray" [class.active]="page === currentPage">
          <button class="page-link" (click)="changePage(page)">{{ page }}</button>
        </li>
        <li class="page-item" [class.disabled]="currentPage === totalPages">
          <button class="page-link" (click)="changePage(currentPage + 1)">Next</button>
        </li>
      </ul>
    </nav>
    
    </div>
</div>


<!-- modal -->
<div class="modal fade" id="shopModal" tabindex="-1" aria-labelledby="shopModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="shopModalLabel">{{ selectedShop?.shop_name }}</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <!-- Modal Body -->
      <div class="modal-body">
        <div class="row">
          
          <!-- Shop Image -->
          <div class="col-md-4 text-center mb-3">
            <img 
              [src]="selectedShop?.store_image || 'assets/default-shop.jpg'" 
              alt="Shop Image" 
              class="img-fluid rounded shadow-sm"
              style="max-height: 200px; object-fit: cover;"
            >
          </div>

          <!-- Shop Details -->
          <div class="col-md-8">
            <ul class="list-group list-group-flush">
              <li class="list-group-item"><strong>Owner Name:</strong> {{ selectedShop?.owner_name }}</li>
              <li class="list-group-item"><strong>Contact No:</strong> {{ selectedShop?.contact_no }}</li>
              <li class="list-group-item"><strong>Shop Code:</strong> {{ selectedShop?.shop_code }}</li>
              <li class="list-group-item"><strong>Address:</strong> {{ selectedShop?.shop_address }}</li>
              <li class="list-group-item"><strong>User:</strong> {{ selectedShop?.user }}</li>
              <li class="list-group-item"><strong>First Name:</strong> {{ selectedShop?.first_name }}</li>
            </ul>
          </div>

        </div>

        <select name="" id="" class="form-control">
            <option value="" disabled selected>Select wallet </option>
            <option value=""> Wallet</option>
            <option value=""> Online Payment</option>
        </select>
      </div>



      <!-- Modal Footer -->
      <div class="modal-footer">
        <button class="btn btn-success" (click)="payShop(selectedShop)">
          <i class="bi bi-wallet2 me-1"></i> Pay
        </button>
        <button class="btn btn-primary" (click)="location(selectedShop)">
          <i class="bi bi-geo-alt-fill"></i> Navigate
        </button>
      </div>

    </div>
  </div>
</div>
